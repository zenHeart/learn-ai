import{_ as e}from"./chunks/plugin-vue_export-helper.DlAUqK2U.js";import{c as s,o as a,ad as i}from"./chunks/mermaid.Cb40Nz1P.js";import"./chunks/cytoscape.C2CwDKBM.js";import"./chunks/dayjs.C32PoDnw.js";const b=JSON.parse('{"title":"可观测性 (Observability)","description":"","frontmatter":{},"headers":[],"relativePath":"zh/tech/engineering/observability.md","filePath":"zh/tech/engineering/observability.md"}'),n={name:"zh/tech/engineering/observability.md"};function l(r,t,o,p,h,d){return a(),s("div",null,[...t[0]||(t[0]=[i(`<h1 id="可观测性-observability" tabindex="-1">可观测性 (Observability) <a class="header-anchor" href="#可观测性-observability" aria-label="Permalink to &quot;可观测性 (Observability)&quot;">​</a></h1><p>在传统软件中，你记录 &quot;Request / Response&quot;。 在 AI 软件中，你必须记录 <strong>Prompts, Completions, Tokens, 和 Latency</strong>。</p><h2 id="需要跟踪的关键指标" tabindex="-1">需要跟踪的关键指标 <a class="header-anchor" href="#需要跟踪的关键指标" aria-label="Permalink to &quot;需要跟踪的关键指标&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">指标</th><th style="text-align:left;">定义</th><th style="text-align:left;">目标</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>TTFT</strong></td><td style="text-align:left;">首个 Token 时间 (Time To First Token)</td><td style="text-align:left;">&lt; 1000ms</td></tr><tr><td style="text-align:left;"><strong>总延迟</strong></td><td style="text-align:left;">完整完成时间</td><td style="text-align:left;">&lt; 5s (取决于上下文)</td></tr><tr><td style="text-align:left;"><strong>Tokens</strong></td><td style="text-align:left;">输入 + 输出长度</td><td style="text-align:left;">最小化 (节省成本)</td></tr><tr><td style="text-align:left;"><strong>成本</strong></td><td style="text-align:left;">每次请求的 $$$</td><td style="text-align:left;">跟踪预算</td></tr><tr><td style="text-align:left;"><strong>错误</strong></td><td style="text-align:left;">429s, 500s</td><td style="text-align:left;">&lt; 1%</td></tr></tbody></table><h2 id="追踪-tracing" tabindex="-1">追踪 (Tracing) <a class="header-anchor" href="#追踪-tracing" aria-label="Permalink to &quot;追踪 (Tracing)&quot;">​</a></h2><p>AI 应用是复杂的链 (RAG: Retriever -&gt; Reranker -&gt; Generator)。 <strong>追踪</strong> 可视化请求的整个瀑布流。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Request] &quot;Who is CEO of Apple?&quot; (2s)</span></span>
<span class="line"><span>  ├── [Retrieve] Pinecone (0.5s)</span></span>
<span class="line"><span>  ├── [Rerank] Cohere (0.2s)</span></span>
<span class="line"><span>  └── [Generate] GPT-4o (1.3s)</span></span></code></pre></div><h2 id="工具" tabindex="-1">工具 <a class="header-anchor" href="#工具" aria-label="Permalink to &quot;工具&quot;">​</a></h2><p>不要自己构建这个。使用专门的代理。</p><ol><li><strong>Helicone</strong>: 开源代理。只需更改 OpenAI SDK 中的 <code>baseURL</code>。<div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> openai</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OpenAI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  baseURL: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://oai.hconeai.com/v1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  defaultHeaders: { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Helicone-Auth&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Bearer HELICONE_KEY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li><li><strong>Langfuse</strong>: 开源追踪和指标。</li><li><strong>Sentry</strong>: 适合错误跟踪，但 Token 成本细节较少。</li></ol><h2 id="隐私编校" tabindex="-1">隐私编校 <a class="header-anchor" href="#隐私编校" aria-label="Permalink to &quot;隐私编校&quot;">​</a></h2><p><strong>警告</strong>: 永远不要将 PII (个人身份信息，如电子邮件或密码) 记录到这些第三方工具中。在记录<em>之前</em>实施编校层。</p>`,12)])])}const u=e(n,[["render",l]]);export{b as __pageData,u as default};
