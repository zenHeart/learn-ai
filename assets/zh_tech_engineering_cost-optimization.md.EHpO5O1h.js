import{_ as a}from"./chunks/plugin-vue_export-helper.DlAUqK2U.js";import{c as s,o as t,ad as e}from"./chunks/mermaid.Cb40Nz1P.js";import"./chunks/cytoscape.C2CwDKBM.js";import"./chunks/dayjs.C32PoDnw.js";const m=JSON.parse('{"title":"成本优化","description":"","frontmatter":{},"headers":[],"relativePath":"zh/tech/engineering/cost-optimization.md","filePath":"zh/tech/engineering/cost-optimization.md"}'),n={name:"zh/tech/engineering/cost-optimization.md"};function o(h,i,l,r,p,d){return t(),s("div",null,[...i[0]||(i[0]=[e(`<h1 id="成本优化" tabindex="-1">成本优化 <a class="header-anchor" href="#成本优化" aria-label="Permalink to &quot;成本优化&quot;">​</a></h1><p>AI 是昂贵的。一个 GPT-4 请求可能花费 0.03 美元。如果你有 10,000 个用户，那就是每天 300 美元。</p><h2 id="策略" tabindex="-1">策略 <a class="header-anchor" href="#策略" aria-label="Permalink to &quot;策略&quot;">​</a></h2><h3 id="_1-模型路由-80-20-法则" tabindex="-1">1. 模型路由 (80/20 法则) <a class="header-anchor" href="#_1-模型路由-80-20-法则" aria-label="Permalink to &quot;1. 模型路由 (80/20 法则)&quot;">​</a></h3><p>80% 的用户查询都很简单 (&quot;嗨&quot;, &quot;谢谢&quot;, &quot;总结这个短文本&quot;)。 <strong>不要对所有事情都使用 GPT-4。</strong></p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> isComplex</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> classifier.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">classify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prompt); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 便宜的 BERT 模型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> isComplex </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;gpt-4o&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;gpt-4o-mini&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><strong>节省</strong>: 便宜 20 倍。</p><h3 id="_2-语义缓存" tabindex="-1">2. 语义缓存 <a class="header-anchor" href="#_2-语义缓存" aria-label="Permalink to &quot;2. 语义缓存&quot;">​</a></h3><p>如果用户 A 问 &quot;谁是总统？&quot;，用户 B 问 &quot;现在的总统是谁？&quot;，他们应该得到相同的缓存答案。 使用 <strong>Redis</strong> 或专门的缓存 (GPTCache) 存储 <code>(embedding(prompt), response)</code>。</p><p><strong>节省</strong>: 100% (免费)。</p><h3 id="_3-提示词压缩" tabindex="-1">3. 提示词压缩 <a class="header-anchor" href="#_3-提示词压缩" aria-label="Permalink to &quot;3. 提示词压缩&quot;">​</a></h3><p>更短的提示词 = 更低的成本。</p><ul><li>删除礼貌用语 (&quot;Please&quot;, &quot;Thank you&quot;)。</li><li>使用专门的语法代替冗长的英语。</li></ul><h3 id="_4-自托管-针对高用量" tabindex="-1">4. 自托管 (针对高用量) <a class="header-anchor" href="#_4-自托管-针对高用量" aria-label="Permalink to &quot;4. 自托管 (针对高用量)&quot;">​</a></h3><p>如果你每月花费 &gt; $5k，考虑在你自己的 GPU 服务器 (AWS EC2 / RunPod) 上托管 Llama 3。</p><h2 id="预算" tabindex="-1">预算 <a class="header-anchor" href="#预算" aria-label="Permalink to &quot;预算&quot;">​</a></h2><p><strong>公式</strong>: <code>成本 = (输入 Tokens * 价格_In) + (输出 Tokens * 价格_Out)</code></p><p><strong>经验法则</strong>:</p><ul><li>1,000 tokens ≈ 750 个单词。</li><li>输出通常比输入贵 3 倍。</li><li>RAG 应用有巨大的输入（上下文）和小的输出。</li></ul><h2 id="警报" tabindex="-1">警报 <a class="header-anchor" href="#警报" aria-label="Permalink to &quot;警报&quot;">​</a></h2><p>在 OpenAI 中设置一个 <strong>硬限制 (Hard Limit)</strong>。如果你不这样做，代码中的 <code>while(true)</code> 循环可能会在一夜之间花费你 10,000 美元。</p>`,21)])])}const _=a(n,[["render",o]]);export{m as __pageData,_ as default};
