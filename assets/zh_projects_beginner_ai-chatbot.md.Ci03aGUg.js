import{_ as l}from"./chunks/plugin-vue_export-helper.DlAUqK2U.js";import{C as h,c as p,o as i,ad as a,b as e,w as n,a as k,G as r,ae as d}from"./chunks/mermaid.Cb40Nz1P.js";import"./chunks/cytoscape.C2CwDKBM.js";import"./chunks/dayjs.C32PoDnw.js";const B=JSON.parse('{"title":"项目教程：构建你的第一个 AI 聊天机器人","description":"","frontmatter":{},"headers":[],"relativePath":"zh/projects/beginner/ai-chatbot.md","filePath":"zh/projects/beginner/ai-chatbot.md"}'),E={name:"zh/projects/beginner/ai-chatbot.md"};function o(g,s,c,y,F,u){const t=h("Mermaid");return i(),p("div",null,[s[1]||(s[1]=a('<h1 id="项目教程-构建你的第一个-ai-聊天机器人" tabindex="-1">项目教程：构建你的第一个 AI 聊天机器人 <a class="header-anchor" href="#项目教程-构建你的第一个-ai-聊天机器人" aria-label="Permalink to &quot;项目教程：构建你的第一个 AI 聊天机器人&quot;">​</a></h1><p><strong>级别</strong>: 初级 <strong>时间</strong>: 30-45 分钟 <strong>技术栈</strong>: Next.js 14, Vercel AI SDK, OpenAI</p><h2 id="简介" tabindex="-1">简介 <a class="header-anchor" href="#简介" aria-label="Permalink to &quot;简介&quot;">​</a></h2><p>在本教程中，你将构建一个功能齐全的 AI 聊天机器人，外观和感觉类似于 ChatGPT。你将学习 AI 工程的核心概念：<strong>API 通信</strong>、<strong>流式传输 (Streaming)</strong> 和 <strong>状态管理</strong>。</p><p><strong>你将构建什么</strong>:</p><ul><li>一个整洁、响应式的聊天界面</li><li>实时文本流（打字效果）</li><li>自动滚动消息列表</li><li>API 问题的错误处理</li></ul><p><a href="#">查看在线演示</a> | <a href="#">查看源代码</a></p><h2 id="先决条件" tabindex="-1">先决条件 <a class="header-anchor" href="#先决条件" aria-label="Permalink to &quot;先决条件&quot;">​</a></h2><ul><li>已安装 Node.js 18+</li><li>OpenAI API Key (<a href="https://platform.openai.com/api-keys" target="_blank" rel="noreferrer">在这里获取</a>)</li><li>代码编辑器（推荐 VS Code）</li></ul><h2 id="架构" tabindex="-1">架构 <a class="header-anchor" href="#架构" aria-label="Permalink to &quot;架构&quot;">​</a></h2><p>我们将使用 <strong>Vercel AI SDK</strong>，它为我们要处理流式传输的复杂部分。</p>',11)),(i(),e(d,null,{default:n(()=>[r(t,{id:"mermaid-66",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20User%0A%20%20%20%20participant%20Client%20as%20Next.js%20Client%20(useChat)%0A%20%20%20%20participant%20Server%20as%20Next.js%20API%20Route%0A%20%20%20%20participant%20OpenAI%20as%20OpenAI%20API%0A%0A%20%20%20%20User-%3E%3EClient%3A%20%E8%BE%93%E5%85%A5%20%22Hello%22%20%E5%B9%B6%E7%82%B9%E5%87%BB%E5%8F%91%E9%80%81%0A%20%20%20%20Client-%3E%3EServer%3A%20POST%20%2Fapi%2Fchat%20%7B%20messages%3A%20%5B...%5D%20%7D%0A%20%20%20%20Server-%3E%3EOpenAI%3A%20%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%E4%B8%8A%E4%B8%8B%E6%96%87%0A%20%20%20%20OpenAI--%3E%3EServer%3A%20%E6%B5%81%E5%BC%8F%E4%BC%A0%E8%BE%93%E5%93%8D%E5%BA%94%E5%9D%97%0A%20%20%20%20Server--%3E%3EClient%3A%20%E6%B5%81%E5%BC%8F%E4%BC%A0%E8%BE%93%E5%93%8D%E5%BA%94%E5%9D%97%20(SSE)%0A%20%20%20%20Client--%3E%3EUser%3A%20%E5%AE%9E%E6%97%B6%E6%9B%B4%E6%96%B0%20UI%0A"})]),fallback:n(()=>[...s[0]||(s[0]=[k(" Loading... ",-1)])]),_:1})),s[2]||(s[2]=a(`<hr><h2 id="步骤-1-创建新的-next-js-项目" tabindex="-1">步骤 1: 创建新的 Next.js 项目 <a class="header-anchor" href="#步骤-1-创建新的-next-js-项目" aria-label="Permalink to &quot;步骤 1: 创建新的 Next.js 项目&quot;">​</a></h2><p>打开终端并运行：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create-next-app@latest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-ai-chatbot</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 选择以下选项：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - TypeScript: Yes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - ESLint: Yes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - Tailwind CSS: Yes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - src/ directory: Yes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - App Router: Yes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - Import alias: @/*</span></span></code></pre></div><p>进入你的文件夹：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-ai-chatbot</span></span></code></pre></div><h2 id="步骤-2-安装依赖" tabindex="-1">步骤 2: 安装依赖 <a class="header-anchor" href="#步骤-2-安装依赖" aria-label="Permalink to &quot;步骤 2: 安装依赖&quot;">​</a></h2><p>我们需要 Vercel AI SDK 和 OpenAI SDK。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ai</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openai</span></span></code></pre></div><h2 id="步骤-3-配置环境变量" tabindex="-1">步骤 3: 配置环境变量 <a class="header-anchor" href="#步骤-3-配置环境变量" aria-label="Permalink to &quot;步骤 3: 配置环境变量&quot;">​</a></h2><p>在项目根目录下创建一个名为 <code>.env.local</code> 的文件：</p><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>OPENAI_API_KEY=sk-your-openai-key-here</span></span></code></pre></div><blockquote><p><strong>安全警告</strong>: 永远不要将此文件提交到 Git！<code>.env.local</code> 文件默认已在 <code>.gitignore</code> 中。</p></blockquote><h2 id="步骤-4-创建-api-路由" tabindex="-1">步骤 4: 创建 API 路由 <a class="header-anchor" href="#步骤-4-创建-api-路由" aria-label="Permalink to &quot;步骤 4: 创建 API 路由&quot;">​</a></h2><p>此后端路由将充当你的用户和 OpenAI 之间的安全代理。</p><p>创建 <code>src/app/api/chat/route.ts</code>:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { openai } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@ai-sdk/openai&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { streamText } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;ai&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 允许流式响应最长 30 秒</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> maxDuration</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> POST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">req</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">messages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> req.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> streamText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    model: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openai</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;gpt-4o&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    messages,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toDataStreamResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="步骤-5-构建聊天界面" tabindex="-1">步骤 5: 构建聊天界面 <a class="header-anchor" href="#步骤-5-构建聊天界面" aria-label="Permalink to &quot;步骤 5: 构建聊天界面&quot;">​</a></h2><p>现在是前端部分。我们将使用 <code>useChat</code> hook，它会自动处理：</p><ul><li>发送消息</li><li>流式传输响应</li><li>更新消息历史状态</li></ul><p>将 <code>src/app/page.tsx</code> 替换为：</p><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;use client&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useChat } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;ai/react&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Chat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">messages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">handleInputChange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">handleSubmit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useChat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;flex flex-col w-full max-w-md py-24 mx-auto stretch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {messages.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        messages.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{m.id} </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;whitespace-pre-wrap py-4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">span</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;font-bold&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;{m.role </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;user&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;用户: &#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;AI: &#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">span</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            {m.content}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text-center text-gray-500 my-10&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          开始对话吧！</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      )}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">form</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onSubmit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{handleSubmit} </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fixed bottom-0 w-full max-w-md p-4 bg-white border-t&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">input</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;w-full p-2 border border-gray-300 rounded shadow-xl&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{input}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          placeholder</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;说点什么...&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          onChange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{handleInputChange}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">form</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="步骤-6-添加基础样式" tabindex="-1">步骤 6: 添加基础样式 <a class="header-anchor" href="#步骤-6-添加基础样式" aria-label="Permalink to &quot;步骤 6: 添加基础样式&quot;">​</a></h2><p>让我们让它看起来更整洁。打开 <code>src/app/globals.css</code> 并确保保留 Tailwind 指令，但如果你想要一个干净的开始，可以清除其余部分。</p><p><code>page.tsx</code> 中的类 (<code>flex flex-col</code>, <code>whitespace-pre-wrap</code> 等) 将处理布局。</p><h2 id="步骤-7-运行并测试" tabindex="-1">步骤 7: 运行并测试 <a class="header-anchor" href="#步骤-7-运行并测试" aria-label="Permalink to &quot;步骤 7: 运行并测试&quot;">​</a></h2><p>启动你的开发服务器：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre></div><p>打开 <a href="http://localhost:3000" target="_blank" rel="noreferrer">http://localhost:3000</a>。输入 &quot;Tell me a joke&quot; 并按回车。你应该能看到响应流式传输进来！</p><hr><h2 id="故障排除" tabindex="-1">故障排除 <a class="header-anchor" href="#故障排除" aria-label="Permalink to &quot;故障排除&quot;">​</a></h2><p><strong>问题: 401 Unauthorized Error</strong></p><ul><li><strong>原因</strong>: API Key 无效或缺少 <code>.env.local</code> 文件。</li><li><strong>修复</strong>: 检查 <code>.env.local</code> 是否存在且 <code>OPENAI_API_KEY</code> 是否正确。重启服务器。</li></ul><p><strong>问题: 429 Too Many Requests</strong></p><ul><li><strong>原因</strong>: 你的 OpenAI 额度用完了。</li><li><strong>修复</strong>: 在 OpenAI 控制台检查你的账单设置。</li></ul><p><strong>问题: &quot;Module not found&quot;</strong></p><ul><li><strong>原因</strong>: 依赖未安装。</li><li><strong>修复</strong>: 再次运行 <code>npm install ai openai</code>。</li></ul><hr><h2 id="扩展-让它更好" tabindex="-1">扩展：让它更好 <a class="header-anchor" href="#扩展-让它更好" aria-label="Permalink to &quot;扩展：让它更好&quot;">​</a></h2><p>现在你已经掌握了基础知识，尝试这些挑战：</p><h3 id="级别-1-更好的-ui" tabindex="-1">级别 1: 更好的 UI <a class="header-anchor" href="#级别-1-更好的-ui" aria-label="Permalink to &quot;级别 1: 更好的 UI&quot;">​</a></h3><p>使用像 <strong>shadcn/ui</strong> 这样的组件库，让聊天气泡看起来像 iMessage 或 WhatsApp。</p><ul><li>用户消息：蓝色背景，右对齐。</li><li>AI 消息：灰色背景，左对齐。</li></ul><h3 id="级别-2-添加系统提示词-system-prompt" tabindex="-1">级别 2: 添加系统提示词 (System Prompt) <a class="header-anchor" href="#级别-2-添加系统提示词-system-prompt" aria-label="Permalink to &quot;级别 2: 添加系统提示词 (System Prompt)&quot;">​</a></h3><p>给你的机器人一个个性。更新 <code>route.ts</code>:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> streamText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    model: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openai</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;gpt-4o&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    system: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;You are a pirate. Respond to everything in pirate speak.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 添加这一行</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    messages,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span></code></pre></div><h3 id="级别-3-markdown-支持" tabindex="-1">级别 3: Markdown 支持 <a class="header-anchor" href="#级别-3-markdown-支持" aria-label="Permalink to &quot;级别 3: Markdown 支持&quot;">​</a></h3><p>AI 返回 Markdown (粗体、列表、代码块)。使用 <code>react-markdown</code> 来正确渲染它。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react-markdown</span></span></code></pre></div><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReactMarkdown </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;react-markdown&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 在你的 map 循环中:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReactMarkdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;{m.content}&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReactMarkdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><hr><h2 id="下一步" tabindex="-1">下一步 <a class="header-anchor" href="#下一步" aria-label="Permalink to &quot;下一步&quot;">​</a></h2><p>恭喜！你已经构建了一个流式 AI 应用。</p><ul><li><strong>了解更多 API 信息</strong>: <a href="./../../integration/apis/openai.html">OpenAI 集成指南</a></li><li><strong>尝试更大的项目</strong>: <a href="./../../paths/integration.html">路径 2: 集成学习路径</a></li></ul>`,54))])}const D=l(E,[["render",o]]);export{B as __pageData,D as default};
