---
layout: section
---

# å®æˆ˜æ¼”ç¤ºï¼ˆDemoï¼‰

æœ¬æ¼”ç¤ºä¸ºçŸ­æµç¨‹ç¤ºä¾‹ï¼Œç›®æ ‡æ˜¯å±•ç¤ºå¦‚ä½•åœ¨ Vibe Coding ä¸­ä¸ AI åä½œå®Œæˆä¸€é¡¹å°ä»»åŠ¡ã€‚

---

## ç¤ºä¾‹ä»»åŠ¡ï¼šå®ç°å¹¶æµ‹è¯•ä¸€ä¸ªèŠ‚æµï¼ˆthrottleï¼‰å‡½æ•°

### Step 1: è¯´æ˜ä»»åŠ¡

**Driver**ï¼šæˆ‘éœ€è¦ä¸€ä¸ª `throttle(fn, wait)` å®ç°ï¼Œè¦æ±‚ï¼š

- åœ¨é«˜é¢‘è§¦å‘ä¸‹ï¼Œæ¯éš” `wait` æ¯«ç§’åªæ‰§è¡Œä¸€æ¬¡
- ä¿ç•™ç«‹å³æ‰§è¡Œé€‰é¡¹ (leading/trailing)
- æä¾› `cancel()` æ–¹æ³•

è¯·ç»™å‡ºå®ç°å¹¶æä¾› Jest æµ‹è¯•ç”¨ä¾‹ã€‚

---

### Step 2: å‘é€ Prompt ç»™ AI

```
è¯·å®ç°ä¸€ä¸ª JavaScript çš„ `throttle(fn, wait, options)` å‡½æ•°ï¼š

- `fn`ï¼šè¦èŠ‚æµçš„å‡½æ•°
- `wait`ï¼šé—´éš”æ¯«ç§’
- `options` å¯é€‰ï¼Œ{ leading: boolean, trailing: boolean }

è¦æ±‚ï¼š
1. å‡½æ•°è¿”å›ä¸€ä¸ªæœ‰ `cancel()` æ–¹æ³•çš„åŒ…è£…å‡½æ•°
2. leading: true æ—¶ï¼Œé¦–æ¬¡è°ƒç”¨ç«‹å³æ‰§è¡Œ
3. trailing: true æ—¶ï¼Œæœ€åä¸€æ¬¡è°ƒç”¨ä¼šåœ¨ wait åæ‰§è¡Œ
4. æä¾›å®Œæ•´çš„ Jest æµ‹è¯•ç”¨ä¾‹ï¼Œè¦†ç›– leading/trailing è¡Œä¸ºå’Œ cancel
```

---

### Step 3: AI è¿”å›çš„å®ç°

```javascript
function throttle(fn, wait, options = {
  leading: true, 
  trailing: true
}) {
  let timer = null;
  let lastArgs = null;
  let lastThis = null;
  let lastCallTime = 0;

  function invoke() {
    fn.apply(lastThis, lastArgs);
    lastArgs = lastThis = null;
  }

  const wrapper = function(...args) {
    const now = Date.now();
    lastArgs = args;
    lastThis = this;
    
    if (!timer && options.leading) {
      invoke();
      lastCallTime = now;
    }
    if (!timer && options.trailing) {
      timer = setTimeout(() => {
        timer = null;
        if (lastArgs) invoke();
      }, wait);
    }
  };
  // ...
```

::right::

<div style="padding-left: 20px;">

```javascript
  // ... ç»­

  wrapper.cancel = function() {
    if (timer) clearTimeout(timer);
    timer = null;
    lastArgs = lastThis = null;
  };

  return wrapper;
}

module.exports = { throttle };
```

<div style="margin-top: 20px; padding: 16px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #0ea5e9;">

**ğŸ’¡ AI è¯´æ˜**ï¼š

è¿™ä¸ªå®ç°æ”¯æŒ leading å’Œ trailing ä¸¤ç§æ¨¡å¼ï¼š

- `leading: true` é¦–æ¬¡è°ƒç”¨ç«‹å³æ‰§è¡Œ
- `trailing: true` æœ€åè§¦å‘ä¼šå»¶è¿Ÿæ‰§è¡Œ
- `cancel()` ç”¨äºæ¸…ç†å®šæ—¶å™¨

</div>

</div>

---

### Step 4: AI ç”Ÿæˆçš„ Jest æµ‹è¯•

```javascript
const { throttle } = require('./throttle');

describe('throttle', () => {
  jest.useFakeTimers();
  
  test('leading: true - é¦–æ¬¡è°ƒç”¨ç«‹å³æ‰§è¡Œ', () => {
    const fn = jest.fn();
    const throttled = throttle(fn, 100, { leading: true, trailing: false });
    
    throttled();
    expect(fn).toHaveBeenCalledTimes(1);
  });

  test('trailing: true - æœ€åä¸€æ¬¡è°ƒç”¨å»¶è¿Ÿæ‰§è¡Œ', () => {
    const fn = jest.fn();
    const throttled = throttle(fn, 100, { leading: false, trailing: true });
    
    throttled();
    throttled();
    expect(fn).not.toHaveBeenCalled();
    
    jest.advanceTimersByTime(100);
    expect(fn).toHaveBeenCalledTimes(1);
  });

  test('cancel - å–æ¶ˆå¾…æ‰§è¡Œçš„è°ƒç”¨', () => {
    const fn = jest.fn();
    const throttled = throttle(fn, 100, { leading: false, trailing: true });
    
    throttled();
    throttled.cancel();
    jest.advanceTimersByTime(100);
    expect(fn).not.toHaveBeenCalled();
  });
});
```

---

### Step 5: éªŒè¯ä¸åˆå…¥

<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 20px;">

<div style="padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white;">

**ğŸ§ª Driver è¿è¡Œæµ‹è¯•**

```bash
npm test throttle.test.js
```

ç¡®è®¤æ‰€æœ‰æµ‹è¯•é€šè¿‡

</div>

<div style="padding: 20px; background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); border-radius: 12px; color: white;">

**ğŸ‘€ Navigator éªŒè¯é€»è¾‘**

- æ£€æŸ¥è¾¹ç•Œæ¡ä»¶å¤„ç†
- ç¡®è®¤ this ç»‘å®šæ­£ç¡®
- éªŒè¯å†…å­˜æ³„æ¼é£é™©

</div>

<div style="padding: 20px; background: linear-gradient(135deg, #fc5c7d 0%, #6a82fb 100%); border-radius: 12px; color: white;">

**ğŸ“ å›¢é˜Ÿè®¨è®ºå¹¶æ”¶å½•**

- è¡¥å…… edge case
- å°† prompt å­˜å…¥çŸ¥è¯†åº“
- æ ‡æ³¨ä½¿ç”¨åœºæ™¯

</div>

</div>

---

# Demo å°ç»“

<div style="display: flex; gap: 30px; margin-top: 30px;">

<div style="flex: 1; padding: 24px; background: #1e1e2e; border-radius: 12px; color: #cdd6f4;">

### âœ… æœ¬æ¬¡æ¼”ç¤ºæ¶µç›–

- å¦‚ä½•æŠŠä»»åŠ¡æ‹†è§£ä¸ºæ¸…æ™° prompt
- AI ç”Ÿæˆä»£ç çš„å…¸å‹ç»“æ„
- äººå·¥æ ¡éªŒçš„å…³é”®æ­¥éª¤
- æµ‹è¯•é©±åŠ¨çš„å¼€å‘é—­ç¯

</div>

<div style="flex: 1; padding: 24px; background: #1e1e2e; border-radius: 12px; color: #cdd6f4;">

### ğŸ”„ å®Œæ•´é—­ç¯æµç¨‹

```mermaid
graph LR
    A[ä»»åŠ¡æè¿°] --> B[Prompt æ„å»º]
    B --> C[AI ç”Ÿæˆ]
    C --> D[äººå·¥æ ¡éªŒ]
    D --> E[æµ‹è¯•è¿è¡Œ]
    E --> F[åˆå…¥ä¸»å¹²]
    F --> G[çŸ¥è¯†åº“æ”¶å½•]
```

</div>

</div>

<br/>

> ğŸ’¡ **è®°ä½**ï¼šAI æ˜¯ä½ çš„ç»“å¯¹ç¼–ç¨‹ä¼™ä¼´ï¼Œä½†æœ€ç»ˆå†³ç­–æƒåœ¨ä½ æ‰‹ä¸­ï¼
