# 2. MCP 架构

## 核心架构：三个关键参与者

```
┌─────────────────────────────────────────────────────┐
│                    MCP Host                         │
│              (Claude Desktop, Cursor)                │
├─────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────┐   │
│  │              MCP Client                      │   │
│  │         维护与 Server 的连接                   │   │
│  └─────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────┐
│                   MCP Server                        │
│    提供工具、资源、提示词                             │
└─────────────────────────────────────────────────────┘
```

---

# 三方架构详解

<div class="grid grid-cols-3 gap-4">

<div>

### 1. MCP Host

* **定义**: AI 应用（如 Claude Desktop、Cursor）
* **职责**: 控制中心，决定何时调用工具
* **能力**: 工具注册、请求调度、响应处理

</div>

<div>

### 2. MCP Client

* **定义**: 集成在 Host 内部
* **职责**: 维护与特定 Server 的连接
* **能力**: 连接管理、请求路由、事件处理

</div>

<div>

### 3. MCP Server

* **定义**: 能力提供者
* **职责**: 暴露工具、资源和提示词
* **能力**: 工具执行、数据访问、业务逻辑

</div>

</div>

---

# 通信方式

<div class="grid grid-cols-3 gap-4 text-sm">

<div class="bg-slate-50 dark:bg-slate-800/50 p-3 rounded-lg">

**stdio** - 本地进程

```json
{ "command": "node", "args": ["server.js"] }
```

适用于本地 Server

</div>

<div class="bg-slate-50 dark:bg-slate-800/50 p-3 rounded-lg">

**SSE** - HTTP 长连接

```json
{ "type": "http", "url": "/mcp" }
```

适用于远程 Server

</div>

<div class="bg-slate-50 dark:bg-slate-800/50 p-3 rounded-lg">

**WebSocket** - 双向实时通信

适用于需要长连接的实时场景

</div>

</div>

---

# 协议核心概念

<div class="grid grid-cols-3 gap-4 text-sm">

<div class="bg-blue-50 dark:bg-blue-900/30 p-3 rounded-lg border border-blue-200 dark:border-blue-800">

**Tools** - 工具

AI 可调用的函数

* 输入参数定义
* 输出模式声明

</div>

<div class="bg-green-50 dark:bg-green-900/30 p-3 rounded-lg border border-green-200 dark:border-green-800">

**Resources** - 资源

只读数据流

* AI 可读取
* 不能修改

</div>

<div class="bg-purple-50 dark:bg-purple-900/30 p-3 rounded-lg border border-purple-200 dark:border-purple-800">

**Prompts** - 提示词

预定义提示词模板

* 可被 AI 复用
* 标准化格式

</div>

</div>

---
layout: center
---
# 本章小结：MCP 架构

<v-clicks>

1. **三方架构**: Host、Client、Server
2. **通信方式**: stdio、SSE、WebSocket
3. **核心概念**: Tools、Resources、Prompts

</v-clicks>
